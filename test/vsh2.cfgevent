"config"
{
	// same as "weapons" with "*" params, except it doesnt limit to only the player and gets executed before "weapons"
	"globals"
	{
		"reset_vsh2player"
		{
			"<enum>"
			{
				"procedure"	"ConfigEvent_AllocateParams"

				"<enum>"
				{
					"name"	"ZERO"
					"type"	"int"
					"value"	"0"
				}
			}
			"<enum>"
			{
				"procedure"	"ConfigEvent_SetProp"
				"vsh2target"	"player"

				"<enum>"
				{
					"custom"	"vsh2player"
					"prop"	"iChainStab"
					"value"	"ZERO"
				}

			}
		}
		"downloads"
		{
			"<enum>"
			{
				"procedure"	"ConfigEvent_Download"

				"sounds"
				{
					"<enum>"	"sound/vsh_rewrite/stab01.mp3"
					"<enum>"	"sound/vsh_rewrite/stab02.mp3"
					"<enum>"	"sound/vsh_rewrite/stab03.mp3"
					"<enum>"	"sound/vsh_rewrite/stab04.mp3"
				}
			}
		}
	}
	"weapons"
	{
		//Scout 侦察兵
		"773"	//Pretty Boy's Pocket Pistol 帅气男孩的袖珍手枪
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_GetProp"

					"<enum>"
					{
						"vsh2target"	"player"
						"name"	"iMyHealth"
						"type"	"int"
						"size"	"4"
						"prop"	"m_iHealth"
						"datamap"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfHeal"
					"vsh2target"	"player"

					"health"
					{
						"formula"	"A + 5"
						"<enum>"
						{
							"token"	"A"
							"value"	"@iMyHealth"
						}
					}
					"clamp"		 "199"
				}
			}
		}
		"44"	//Sandman 睡魔
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_SandManStun"
					"vsh2player"	"player"
					"victim"	"victim"
				}
			}
		}
		//Soldier 士兵
		"226"	//The Battalion's Backup 军队的支援
		{
			"banner_start"
			{
				"<enum>"
				{
					"procedure"	 "ConfigEvent_SummonZombie"
					"<passive>"	"true"
					"minion can execute"	"false"

					"vsh2target"	 "owner"
					"max players"	 "3"

					"vampire"		 "10.0"	// steal 5.0% of victim's health on attack

					"slay"			"true"  // slay when the owner dies
					"no boss"		"true"  // dont summon as minion if the player was previously a boss

					"allow weapons" "false" // allow minions to use execute weapons config ('bCfgSysXAllow')
					"delay"			"0.1"	// spawn minion after 'delay' seconds
					"spawn"		 "false" // true to teleport directly to spawn

					"climb"
					{
						"enable"	"true"
						"velocity"  "400.0"
					}

					"conditions"
					{
						"<enum>"
						{
							"id"	"25"	//Bleed cond 流血
							"value" "-1.0"
						}
					}

					"info"
					{
						"<enum>"
						{
							"class"	 "scout"
							"health"	"125.0"
							"model"	 "models/player/scout.mdl"

							"text"  "你现在是 %N 召唤的僵尸！攻击敌人！"

							"classname"  "tf_weapon_bat"
							"attributes" "68 ; -1 ; 1 ; 0.5"
							"index"	  "190"
							"ammo"		"-9"
							"clip"		"-9"

							"particle"	"ghost_smoke"
						}
					}
				}
			}
		}
		"133"	//Gunboats 炮艇
		{
			"falldamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_FormatParams"
					"<passive>"	"true"

					"<enum>"
					{
						"name"	"damage_str"
						"value"	"0.5 * {0}"
						"size"	"128"
						"args"
						{
							"<enum>"	"f@damage"
						}
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ParseForumla"
					"<passive>"	"true"

					"<enum>"
					{
						"name"	"damage"
						"from"	"@damage_str"
						"truncate"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_WriteReturn"

					"return"	"changed"
				}
			}
		}
		"442"	//Righteous Bison 正义野牛
		{
			"think"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_SetClipEnergy"
					"vsh2target"	"player"

					"ammount"	"100.0"
					"max"	"100.0"
					"slot"	"1"
					"duration"	"-1.0"
				}
			}
		}
		//Pyro 火焰兵
		"21, 208, 40, 215, 659, 741, 798, 807, 887, 896, 905, 914, 963, 972, 1146, 1178, 15005, 15017, 15030, 15034, 15049, 15054, 15066, 15067, 15068, 15089, 15090, 15115, 15141, 30474"
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_GetProp"

					"<enum>"
					{
						"vsh2target"	"player"
						"name"	"iMyHealth"
						"type"	"int"
						"size"	"4"
						"prop"	"m_iHealth"
						"datamap"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfHeal"
					"vsh2target"	"player"

					"health"
					{
						"formula"	"A + 2"
						"<enum>"
						{
							"token"	"A"
							"value"	"@iMyHealth"
						}
					}
					"clamp"		 "280"
				}
			}
		}
		"594"	//Phlogistinator 燃素喷射器
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_GetProp"

					"<enum>"
					{
						"vsh2target"	"player"
						"name"	"iMyHealth"
						"type"	"int"
						"size"	"4"
						"prop"	"m_iHealth"
						"datamap"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfHeal"
					"vsh2target"	"player"

					"health"
					{
						"formula"	"A + 1"
						"<enum>"
						{
							"token"	"A"
							"value"	"@iMyHealth"
						}
					}
					"clamp"		 "280"
				}
			}
		}
		//Demoman 爆破手
		"131, 1144"	//Chargin' Targe 冲锋盾
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfTFCond"
					"<passive>"	"true"
					"vsh2target"	"player"
					"add"	"true"
					"conditions"
					{
						"<enum>"
						{
							"id"	"26"
							"duration"	"4.0"
						}
					}
				}
			}
		}
		"406"	//Splendid Screen 辉煌护盾
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfTFCond"
					"<passive>"	"true"
					"vsh2target"	"victim"

					"add"	"true"
					"conditions"
					{
						"<enum>"
						{
							"id"	"127"
							"duration"	"-1.0"
						}
					}
				}
			}
		}
		"1099"	//Tide Turner 力挽狂澜
		{
			"prep_redteam"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_SetAttribWep"
					"<passive>"	"true"
					"vsh2target"	"player"

					"attributes"
					{
						"<enum>"
						{
							"slot"	"2"
							"index"	"778"
							"value"	"0.75"
							"duration"	"-1.0"
						}
					}
				}
			}
		}
		"327"	//Claidheamh Mòr 摩尔巨剑
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_GetProp"

					"<enum>"
					{
						"vsh2target"	"player"
						"name"	"fChargeMeter"
						"type"	"float"
						"size"	"5"
						"prop"	"m_flChargeMeter"
						"datamap"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_FormatParams"

					"<enum>"
					{
						"name"	"formatted_value"
						"value"	"{0} + 25.0"
						"size"	"4"
						"args"
						{
							"<enum>"	"f@fChargeMeter"
						}
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ParseForumla"

					"<enum>"
					{
						"name"	"final_chargemeter"
						"from"	"@formatted_value"
						"truncate"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_SetProp"

					"<enum>"
					{
						"vsh2target"	"player"
						"type"	"float"
						"prop"	"m_flChargeMeter"
						"datamap"	"false"
						"value"	"final_chargemeter"
					}
				}
			}
		}
		//Heavy 机枪手
		"43"	//Killing Gloves of Boxing 杀戮拳击手套
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfTFCond"
					"add"	"true"
					"conditions"
					{
						"vsh2target"	"player"
						"id"	"56"
						"duration"	"7.0"
					}
				}
			}
		}
		"310"	//Warrior's Spirit 勇士之魂
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_GetProp"

					"<enum>"
					{
						"vsh2target"	"player"
						"name"	"iMyHealth"
						"type"	"int"
						"size"	"4"
						"prop"	"m_iHealth"
						"datamap"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfHeal"
					"vsh2target"	"player"
					"health"
					{
						"formula"	"A + 75"
						"<enum>"
						{
							"token" "A"
							"value"	"@iMyHealth"
						}
					}
					"clamp"	"500"
				}
			}
		}
		//Engineer 工程师
		"588"	//Pomson 6000 歼灭者 6000
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_GiveRage"
					"vsh2target"	"victim"

					"damage"	"-200"
				}
			}
		}
		"528"	//Short Circuit 短路发生器
		{
			"projectile_touch"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_Explode"

					"enttarget"	"projectile"
					"damage"	"45.0"
					"radius"	"120.0"
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_DestroyEntity"

					"enttarget"	"projectile"
				}
			}
		}
		"140, 1086, 30668"	//Wrangler 遥控手柄
		{
			"think"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfTFCond"
					"vsh2target"	"player"
					"add"	"true"
					"conditions"
					{
						"<enum>"
						{
							"id"	"78"
							"duration"	"0.15"
						}
					}
				}
			}
		}
		"589"	//Eureka Effect 传送扳手
		{
			"eureka_teleport"
			{
				"<enum>"
				{
					"procedure"		"ConfigEvent_BlockCommand"	//only block if in cooldown
					"vsh2target"	"player"
				}
			}
			"eureka_teleported"
			{
				"<enum>"
				{
					"procedure"		"ConfigEvent_StartCoolDown"
					"vsh2target"	"player"

					"cooldown"		"45.0"	//45 seconds to set bIsEukuraEffectCD to false
				}
				"<enum>"
				{
					"procedure"		"ConfigEvent_MakeStun"
					"vsh2target"	"player"

					"duration"		"6.0"
					"flags"		"110"	//TF_STUNFLAG_BONKSTUCK | TF_STUNFLAG_LIMITMOVEMENT
				}
				"<enum>"
				{
					"procedure"		"ConfigEvent_SetClientGlow"
					"vsh2target"	"player"

					"addtime"		"10.0"
				}
			}
		}
		//Medic 医生
		"36"	//Blutsauger 吸血鬼针筒枪
		{
			"btd_takedamage"
			{
				// ConfigEvent_GetProp(...);
				"<enum>"
				{
					"procedure"  "ConfigEvent_GetProp"

					"vsh2target"	"player"

					"<enum>"
					{
						"name"	"iCurHealth"
						"type"	"int"
						"prop"  "m_iHealth"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_GetProp"

					"<enum>"
					{
						"vsh2target"	"player"
						"name"	"iMyHealth"
						"type"	"int"
						"size"	"4"
						"prop"	"m_iHealth"
						"datamap"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfHeal"
					"vsh2target"	"player"

					"health"
					{
						"formula"	"A + 5"
						"<enum>"
						{
							"token"	"A"
							"value"	"@iMyHealth"
						}
					}
					"clamp"		 "270"
				}
			}
		}
		"29, 211, 663, 796, 805, 885, 894, 903, 912, 961, 970, 15008, 15010, 15025, 15039, 15050, 15078, 15097, 15121, 15122, 15123, 15145, 15146"	//Stock Medigun 原配医疗枪
		{
			"think"
			{
				"<enum>"
				{
					"procedure"		"ConfigEvent_ManagePatientTFCond"
					"vsh2target"	"player"

					"add"			"true"
					"conditions"
					{
						"<enum>"
						{
							"id"		"16"	//minicrits
							"duration"		"0.05"	//good for onplayerthink
						}
					}
				}
			}
		}
		"35"	//The Kritzkrieg 闪电战医疗枪
		{
			"think"
			{
				"<enum>"
				{
					"procedure"		"ConfigEvent_ManagePatientTFCond"
					"vsh2target"	"player"

					"add"		"true"
					"conditions"
					{
						"<enum>"
						{
							"id"		"16"
							"duration"		"0.05"
						}
					}
				}
			}
			"uber_deploy"
			{
				"<enum>"
				{
					"procedure"		"ConfigEvent_ManageSelfTFCond"
					"vsh2target"	"medic"

					"add"		"true"
					"conditions"
					{
						"<enum>"
						{
							"id"		"42"
							"duration"		"8.0"
						}
					}
				}
			}
			"uber_loop"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageAreaTFCond"
					"vsh2target"	"medic"

					"flags"	"1"
					"distance"	"<250.0"
					"conditions"
					{
						"<enum>"
						{
							"id"	"11"
							"duration"	"3.0"
						}
					}
				}
			}
		}
		"411"	//Quick Fix 快速医疗枪
		{
			"uber_loop"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageAreaTFCond"
					"vsh2target"	"medic"

					"flags"	"1"
					"distance"	"<300.0"
					"conditions"
					{
						"<enum>"
						{
							"id"	"32"
							"duration"	"5.0"
						}
					}
				}
			}
		}
		"413"	//Solemn Vow 希波克拉底的塑像
		{
			"playerhud"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_ViewRage"
					"<passive>"	"true"
					"vsh2target"	"player"

					"string"    "Boss Rage: %f"
				}
			}
		}
		//Sniper 狙击手
		"56, 1005, 1092"	//Huntsman 猎人短弓
		{
			"projectile_touch"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_Explode"

					"enttarget"	"projectile"
					"damage"	"45.0"
					"radius"	"120.0"
				}
			}
		}
		"752"	//Hitman's Heatmaker 职业杀手的手感
		{
			"btd_takedamage"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_GetProp"
					"<enum>"
					{
						"name"	"rage_meter"
						"vsh2target"	"player"
						"size"	"5"
						"type"	"float"
						"prop"	"m_flRageMeter"
						"datamap"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_FormatParams"

					"<enum>"
					{
						"name"	"formatted_value"
						"value"	"{0} + 40.0"
						"size"	"6"
						"args"
						{
							"<enum>"	"f@rage_meter"
						}
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ParseForumla"

					"<enum>"
					{
						"name"	"final_rage_meter"
						"from"	"@formatted_value"
						"truncate"	"false"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_SetProp"
					"vsh2target"	"player

					"<enum>"
					{
						"type"	"float"
						"size"	"6"
						"prop"	"m_flRageMeter"
						"datamap"	"false"
						"value"	"final_rage_meter"
						"max"	"100.0"
					}
				}
			}
		}
		"171"	//Tribalman's Shiv 部落者刮刀
		{
			"playerclimb"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_AllocateParams"

					"<enum>"
					{
						"name"	"attackdelay"
						"type"	"bool"
						"value"	"false"
					}
					"<enum>"
					{
						"name"	"upwardvel"
						"type"	"float"
						"value"	"450.0"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_WriteReturn"

					"return"	"changed"
				}
			}
		}
		"232"	//Bushwacka 灌木丛
		{
			"playerclimb"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_AllocateParams"

					"<enum>"
					{
						"name"	"upwardvel"
						"type"	"float"
						"value"	"1000.0"
					}
					"<enum>"
					{
						"name"	"health"
						"type"	"int"
						"value"	"40"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_WriteReturn"

					"return"	"changed"
				}
			}
		}
		"401"	//Shahanshah 诸王之王
		{
			"playerclimb"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_AllocateParams"

					"<enum>"
					{
						"name"	"upwardvel"
						"type"	"float"
						"value"	"500.0"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_WriteReturn"

					"return"	"changed"
				}
			}
		}
		//Spy 间谍
		"61, 1006"	//Ambassador 大使手枪
		{
			"btd_ambasssador"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_ManageSelfTFCond"
					"vsh2target"	"player"

					"add"	"true"

					"conditions"
					{
						"<enum>"
						{
							"id"	"32"
							"duration"	"3.0"
						}
					}
				}
			}
		}
		"225"	//Your Eternal Reward 永生的回报
		{
			"btd_stab"
			{
				"<enum>"
				{
					"procedure"	"ConfigEvent_GetProp"
					"vsh2target"	"player"

					"<enum>"
					{
						"name"	"cur_stabs"
						"custom"	"vsh2player"
						"prop"	"iChainStab"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_JumpIf"
					"first"	"cur_stabs"
					"csecond"	"3"
					"operators"	"10"
					"skips"	"4"	//skip the four procedure (DO SOMETHING)
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_FormatParams"

					"<enum>"
					{
						"name"	"new_damage"
						"value"	"{0} * 6 + 666"
						"size"	"128"
						"args"
						{
							"<enum>"	"f@damage"
						}
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ParseForumla"

					"<enum>"
					{
						"name"	"damage"
						"from"	"@new_damage"
						"turncate"	"true"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_AllocateParams"

					"<enum>"
					{
						"name"	"cur_stabs"
						"type"	"int"
						"value"	"0"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_WriteReturn"

					"return"	"changed"
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_JumpIf"
					"first"	"cur_stabs"
					"csecond"	"0"
					"operators"	"1"
					"skips"	"2"	//skip the 2 procedure (DO NOTHING)
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_FormatParams"

					"<enum>"
					{
						"name"	"cur_stabs_str"
						"value"	"{0} + 1"
						"size"	"8"
						"args"
						{
							"<enum>"	"i@cur_stabs"
						}
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_ParseForumla"

					"<enum>"
					{
						"name"	"cur_stabs"
						"from"	"@cur_stabs_str"
						"turncate"	"true"
					}
				}
				"<enum>"	//write the cur_stabs
				{
					"procedure"	"ConfigEvent_SetProp"
					"vsh2target"	"player"

					"<enum>"
					{
						"custom"	"vsh2player"
						"prop"	"iChainStab"
						"value"	"cur_stabs"
					}
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_JumpIf"
					"first"	"cur_stabs"
					"csecond"	"0"
					// cur_stabs <= 0
					"operators"	"100011"	//less or equal
					"skips"	"1"
				}
				"<enum>"	//first stab
				{
					"procedure"	"ConfigEvent_EmitSound"
					"vsh2target"	"player"

					"flags"	"11"	//everyone
					"distance"	"9999.0"	//whole map
					"sound"	"vsh_rewrite/stab01.mp3"
					"time"	"0.0"
					"filter"	"all"
					"type"	"generic"
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_JumpIf"
					"first"	"cur_stabs"
					"csecond"	"1"
					// cur_stabs <= 1
					"operators"	"100011"	//less or equal
					"skips"	"1"
				}
				"<enum>"	//second stab
				{
					"procedure"	"ConfigEvent_EmitSound"
					"vsh2target"	"player"

					"flags"	"11"	//everyone
					"distance"	"9999.0"	//whole map
					"sound"	"vsh_rewrite/stab02.mp3"
					"time"	"0.0"
					"filter"	"all"
					"type"	"generic"
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_JumpIf"
					"first"	"cur_stabs"
					"csecond"	"2"
					// cur_stabs <= 2
					"operators"	"100011"	//less or equal
					"skips"	"1"
				}
				"<enum>"	//third stab
				{
					"procedure"	"ConfigEvent_EmitSound"
					"vsh2target"	"player"

					"flags"	"11"	//everyone
					"distance"	"9999.0"	//whole map
					"sound"	"vsh_rewrite/stab03.mp3"
					"time"	"0.0"
					"filter"	"all"
					"type"	"generic"
				}
				"<enum>"
				{
					"procedure"	"ConfigEvent_JumpIf"
					"first"	"cur_stabs"
					"csecond"	"1"
					// cur_stabs <= 3
					"operators"	"100011"	//less or equal
					"skips"	"1"
				}
				"<enum>"	//forth stab
				{
					"procedure"	"ConfigEvent_EmitSound"
					"vsh2target"	"player"

					"flags"	"11"	//everyone
					"distance"	"9999.0"	//whole map
					"sound"	"vsh_rewrite/stab04.mp3"
					"time"	"0.0"
					"filter"	"all"
					"type"	"generic"
				}
			}
		}
	}
}
